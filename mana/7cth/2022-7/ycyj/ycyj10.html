<!DOCTYPE html> 
<html style class>
<head>
<meta charset=utf-8>
<title>总题：结晶读经纲要　历代志、以斯拉记、尼希米记、以斯帖记|第十篇以斯拉记和尼希米记这两卷恢复的书中心并重要的点—主恢复中正确并适当的领导&lt;/p&gt;</title>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<style>body{background-color:#E0E0E0}p{padding-left:2em;margin:10px 0}p:first-letter{margin-left:-2em}.AA2{color:#008000;text-align:center;font-weight:bolder;font-size:1.3em}.AA3{color:#000000;padding-left:0.5em;text-indent:3em;font-size:1.4em}.AA4{font-size:1em;padding-left:2em;color:#000}.CC1{color:#000000;font-weight:bolder;font-size:1.5em}.CC2{color:#000000;padding-left:2.5em;font-weight:bolder;font-size:1.45em}.CC3{color:#000000;padding-left:3em;font-size:1.4em}.CC4{color:#000000;padding-left:3.5em;font-size:1.38em}</style>
<meta http-equiv=content-security-policy content="default-src 'none'; font-src 'self' data:; img-src 'self' data:; style-src 'unsafe-inline'; media-src 'self' data:; script-src 'unsafe-inline' data:; object-src 'self' data:;">
<style>img[src="data:,"],source[src="data:,"]{display:none!important}</style>
</head>
<body>
<p class=AA2>总题：结晶读经纲要　历代志、以斯拉记、尼希米记、以斯帖记</p>
<p class=AA2>第十篇以斯拉记和尼希米记这两卷恢复的书中心并重要的点—主恢复中正确并适当的领导</p>
<p class=AA4>读经：尼八1~10，十三14、29~31，太二十25~28，二三8~13，来十三7</p>
<p class=CC1>壹　在神永远的经纶中并在主的恢复里，<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=1>领导是根据属灵的度量</span>；领导不是职务性、永久性、组织性或阶级制度的—帖前一5，二1~14，五12~13，来十三7、17、24：</p>
<p class=CC2>一　主对领导的观念<span class>与</span>天然的观念相反；在神子民中间，实际上<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=2>没有按天然意义的领导</span>—太二十25~28，二三8~13：</p>
<p class=CC3>1  　在神新约的经纶里，领导的意思是<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=3>作奴仆服事</span>；任何想要领头的人，必须愿意作奴仆—可十35~45。</p>
<p class=CC3>2  　领导是<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=5>因着</span><span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=4>在生命上长大而成形的</span>，并且是因需要而产生；若是没有需要，领导就不会显明出来—彼前五1~3。</p>
<p class=CC3>3  　为了把关于领导的属人观念摆在一边，神命定祂子民中间的领导应当总是<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=6>根据属灵的度量</span>—徒十三2、9，十四12，加二11~14。</p>
<p class=CC3>4  　主的恢复中没有组织的领导，也没有统一的组织；反之，有一位<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=7>元首直接向众肢体施命令</span>，并有一个生机体，就是基督的身体—弗一22~23。</p>
<p class=CC2>二　按照新约，使徒们的<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=8>权柄</span>是属灵的，也<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=9>是在他们话语的职事里</span>—徒二42，林后十三5~6，帖前二13：</p>
<p class=CC3>1  　他们没有地位上的权柄去干涉召会的事务；只有他们所<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=10>供应的话语有权柄</span>—西四16，来十三7。</p>
<p class=CC3>2  　众召会<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=11>跟随使徒</span>们乃因使徒们有新约<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=12>的教训—</span>腓二12，徒二十17~36。</p>
<p class=CC3>3  　一个召会若走岔或被误导，使徒们就<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=13>有义务和责任</span>，照着那有权柄的神的话<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=14>对付这个情形</span>—26~27节，林后十6，提后一13，四2。</p>
<p class=CC3>4  　领导是<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=15>在使徒的教训里产生</span>、加强并受约束的—多一9。</p>
<p class=CC2>三　在新约里，只有<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=17>一</span><span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=16>个职事</span><span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=18>连同一个领导</span>—徒一17、25，林后四1：</p>
<p class=CC3>1  　今天基督教是<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=19>分裂</span>的，<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=20>因为有太多的领导</span>；因为职事只有一个，所以不该有多于一个的领导。</p>
<p class=CC3>2  　只有一个领导，因为神、主和那灵都是一；<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=21>一个领导</span>是为着基督的身体<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=22>保守那灵的一</span>—弗四3~6。</p>
<p class=CC3>3  　新约给我们看见，在职事里领头的人身上有神代表的权柄，这<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=23>权柄乃是为着建造</span>—林后十三10：</p>
<p class=CC4>a　  神代表的<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=24>权柄是在</span>领头人的<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=25>教训上</span>—林前四17下~21，七17下，十一2，十六1，帖后三6、9、12、14。</p>
<p class=CC4>b　  在各处各召会中<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=26>教导同样的事</span>，乃是保罗代表权柄的明证—林前四17下。</p>
<p class=CC2>四　在新约职事中的领导<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=28>重在新约的教训</span>，过于在新约职事中的领头人—徒二42，提后三10。</p>
<p class=CC1>贰　在<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=30>新约职事中的领导</span>，乃是<span class>神永远经纶控制之异象的领导</span>，而不是控制之人的领导；使徒保罗宣告说，“我故此没有违背那从天上来的异象”—徒二六19：</p>
<p class=CC2>一　神永远的经纶是借着使徒揭示的，但因为信徒失去了对神的经纶正确的领会，就需要由主来<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=29>恢复；神永远的经纶</span>（希腊文，oikonomia，奥依克诺米亚）乃是神的家庭行政，要在基督里将祂自己分赐到祂所拣选并救赎的人里面，使祂得着一个家彰显祂自己，这家就是召会—基督的身体—弗三2、8~9，提前一3~4，三15，弗一10，二21~22，彼前四10。</p>
<p class=CC2>二　“恢复”意即在遭受破坏或失去了以后，再使事物复原或回到正常的情形；“恢复”的意思是照着神永远经纶内容之恢复的当前进展，按圣经里所启示<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=31>神原初的心意和标准而得复原</span>：</p>
<p class=CC3>1  　主的恢复是要<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=32>恢复基督</span>在祂成肉体、总括与加强时期里，<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=33>作我们的中心</span>、实际、生命和一切—西一17下、18下，诗八十1、15、17~19，约一14，林前十五45下，启二4~5、7、17，三7~8、12~13、17~22，四5，五6，约六57，十四21、23，二一15~17，参耶三二39。</p>
<p class=CC3>2  　主的恢复是要<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=34>恢复基督身体的一</span>—约十七11、21~23，弗四3~4上，启一11。</p>
<p class=CC3>3  　主的恢复是要<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=35>恢复基督身体众肢体的功用</span>—弗四15~16，罗十五16，彼前二5、9，林前十四1、4下、12、26、31、39，耶三一33~34（见33注1）。</p>
<p class=CC2>三　这异象必须在我们里面<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=36>日日得更新</span>，成为<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=37>支配我们</span>一切生活、工作与活动的异象—约壹一7，彼前二9，赛二5，诗一一九105，三六8~9。</p>
<p class=CC2>四　一个人离开主的恢复，这指明他从未<span class>看见主的恢复</span>是什么；我们若没有<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=38>看见主恢复的异象</span>，我们实际上就不在主的恢复里—徒二六13~19，参创十三14~18。</p>
<p class=CC2>五　我们在主的恢复里，必须对神永远的经纶有清楚的异象，然后<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=39>被这异象所管制、支配并指引</span>；因为我们在这里乃是在主的恢复里实行神永远的经纶。</p>
<p class=CC2>六　<span class>在主恢复里的领导</span>，乃是神所赐神永远经纶之<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=41>异象的领导</span>；这异象约束、支配并控制我们，使混乱与分裂得以避免—箴二九18上。</p>
<p class=CC2>七　请读摘自“<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=42>时代的异象</span>”之补充。</p>
<p class=CC1>叁　以斯拉记和尼希米记这两卷恢复的书，其中心并重要的点乃是<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=43>正确并适当地领导</span>—尼八1~10：</p>
<p class=CC2>一　在主的恢复里，我们借着那些<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=45>带进异象的人</span>，而在一个职事里有一个控制之<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=44>异象的领导</span>—弗三3~5、9，西一24~29：</p>
<p class=CC3>1  　保罗说他和他的同工是“基督的执事，和<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=46>神的奥秘的管家</span>”（林前四1）；他们是管家，将神的奥秘之属天异象分配给信徒；神的这些奥秘就是基督是神的奥秘，以及召会是基督的奥秘（西二2，弗三4，五32）；这分配的事奉、管家的职分，就是使徒的职事（三2、8~9）。</p>
<p class=CC3>2  　“在此所求于管家的，是要他显为忠信”（林前四2）；我们需要像保罗一样，“<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=47>蒙主怜悯成为忠信的</span>”（七25下，提前一12），使我们能成为忠信的奴仆，习惯地将属灵的<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=48>粮食分给神的家人</span>，就是在召会中将神的话和基督当作生命的供应，供应信徒（太二四45~47）；我们要领悟主的称许和赏赐，与我们工作的大小和分量无关，但与我们是否忠信地完全使用祂的恩赐有关，使我们成为在今世主的工作上忠信的人，好在来世有分于主的快乐（二五21~23，参启三8）。</p>
<p class=CC2>二　唯有在尼希米和以斯拉这样忠信的人<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=50>领导下</span>，以色列才能<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=49>重新构成为神的见证</span>，神在地上的彰显，成为与外邦列国完全不同的子民；这预表神今天所要得着的召会该如何—尼十三14、29~31，提前三15。</p>
<p class=CC2>三　尼希米知道，若<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=51>没有以斯拉</span>，他<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=52>就无法</span>将神的百姓重新构成：</p>
<p class=CC3>1  　在重新构成以色列国的事上，尼希米<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=53>知道自己不认识神的话</span>。</p>
<p class=CC3>2  　以斯拉以认识神的话闻名，尼希米也<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=54>愿意求助</span>于以斯拉。</p>
<p class=CC2>四　照着神圣的原则，身体的<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=55>正确代表</span>总是那些<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=56>与别人配在一起</span>的人—林前一1，出四14下~16：</p>
<p class=CC3>1  　单独是个人主义，但与别人一同被差遣出去，是<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=57>照着身体的原则</span>被差遣—路十1，徒十三1~3，罗十二5，帖前一1。</p>
<p class=CC3>2  　<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=58>单独行动破坏身体</span>的原则。</p>
<p class=CC3>3  　在主的恢复中有一个急切的需要，就是要作建造身体的真实工作；然而这建造的工作只有靠<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=59>配合在一起的同工</span>才能完成—腓二19~22。</p>
<p class=CC2>五　“主给我看见，祂已经预备了许多弟兄，与我<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=60>相调着同作奴仆事奉</span>。我觉得这是主为祂的身体所作主宰的供备，也是现今为着完成祂职事的路”—李常受，一九九七年三月二十四日（李常受文集一九九四至一九九七年第五册，“一封感激、交通的信”，六五七至六五八页）。</p>
<p class=AA2>摘自“时代的异象”之补充：
紧紧跟随今时代的完整异象</p>
<p class=AA3>我们若要事奉神，就我们的异象必须是从创世记亚当的头一个异象，一路直到召会终极出现的新耶路撒冷，这才是完整的异象。这异象乃是直到今天，才向我们完全揭示出来。</p>
<p class=AA3>台北故宫博物院里有幅清明上河图，是一卷很长的图画，一点一点描绘中国文化中的生活；只看头不行，总得从头看到末了，对中国文化的生活，或者说“异象”，才得窥全豹。同样的，我们事奉神也有“清明上河图”，是从亚当在伊甸园里所看见的生命树开始，直到新耶路撒冷，其中也有生命树。新耶路撒冷乃是异象的末了一幕，之后就再没有什么可看的了。</p>
<p class=AA2>……我们乃是在终极的一幕里，带着前面的各幕事奉神……</p>
<p class=AA3>我们既有今时代、终极的异象，就要紧紧跟随。我们绝不是跟随什么人，我们乃是跟随一个异象。如果说我们是跟从某某人，那就是大错；我们乃是跟从一个今时代的异象，也就是神终极完成的异象。</p>
<p class=AA3>主的恢复借着我们亲爱的倪柝声弟兄带进来后，他就因此成了众矢之的。一九三四年，他在杭州结婚，人就借机引起了一个厉害的风波；那使得他非常难过。有一天我去安慰他，对他说，“倪弟兄，你知道在你、我之间，没有一点人情。不是我们两个人有好感，所以你走这条路，我也走这条路；你讲这个道，我也讲这个道。我们南北隔很远；你是南方人，我是北方人。今天我们能走在一起，我不是跟随你这个人，乃是跟随你所带领的这条路。倪弟兄，我愿意告诉你，即使有一天你自己不走这条路了，我还是要走。”我这样说，是因为那次风波，影响到有的人不走这条路了。换句话说，有许多人是跟随人，所以因人而异。然而我告诉倪弟兄：“就是你不走这条路，我还要走这条路；我不会因你而走，也不会因你而不走。我看见这条路是主的路，这是个异象。”</p>
<p class=AA3>五十二年过去了，至今我一点也不懊悔。在这五十二年中，我看见故事一再重演，人来了又去了，一幕又一幕。从台湾岛上的工作开始至今，三十几年中有几次重大的事情发生，甚至我带得救、一手造就出来的弟兄，也离开了主的恢复。异象不变，但人会变，跟从人的也会变。所以我愿语重心长地劝勉诸位：我蒙主怜悯，今天能在这里，把这个异象带给你们；我乃是盼望你们跟随的，不是我这个人，而是我蒙主怜悯所给你们看见的这异象……</p>
<p class=AA3>我只告诉你们一个事实，是主怜悯我，启示给我看见异象。所以我劝你们，不要跟随我，乃要跟随我蒙主怜悯，承继倪弟兄和历代主的仆人所留下，传承给你们看见的这个异象。这实在是从亚当头一幕的异象，直到新耶路撒冷末了一幕的异象（五一至五四页）。</p>
<p class=CC1>真理启示：</p>
<p class=CC3>1  　在神永远的经纶中并在主的恢复里，领导是根据属灵的度量；领导不是职务性、永久性、组织性或阶级制度的。</p>
<p class=CC3>2  　在新约职事中的领导重在新约的教训，过于在新约职事中的领头人；在新约职事中的领导，乃是神永远经纶控制之异象的领导，而不是控制之人的领导。</p>
<p class=CC1>生命经历：</p>
<p class=CC3>1  　在神新约的经纶里，领导的意思是作奴仆服事；任何想要领头的人，必须愿意作奴仆，领导是因着在生命上长大而成形的，并且是因需要而产生；</p>
<p class=CC3>2  　神永远经纶的异象必须在我们里面日日得更新，成为支配我们一切生活、工作与活动的异象，使混乱与分裂得以避免。</p>
<p class=CC1>实行应用：</p>
<p class=CC3>1  　遵守使徒的教训，跟随并教导这独一对职事；避免分裂，竭力保守身体的一。</p>
<p class=CC3>2  　竭力追求主话被构成，蒙怜悯作忠信的管家和奴仆，按时分粮，牧养供应神的儿女。</p>
<p class=CC3>3  　脱离个人主义，活在身体配搭的原则里。</p>
<style>.single-file-highlight-yellow, .single-file-highlight-yellow-mode ::selection { background-color: #ffff7c !important; color: black !important; } .single-file-highlight-pink, .single-file-highlight-pink-mode ::selection { background-color: #ffbbb6 !important; color: black !important; } .single-file-highlight-blue, .single-file-highlight-blue-mode ::selection { background-color: #95d0ff !important; color: black !important; } .single-file-highlight-green, .single-file-highlight-green-mode ::selection { background-color: #93ef8d !important; color: black !important; } span.single-file-highlight-yellow, span.single-file-highlight-pink, span.single-file-highlight-blue, span.single-file-highlight-green { display: inline !important; } .single-file-highlight-hidden { background-color: inherit !important; color: inherit !important; } .single-file-mask { all: initial; display: contents !important; } .single-file-mask.single-file-page-mask { opacity: .99 !important; } single-file-note { all: initial !important; display: contents !important; } .single-file-cut-hover, .single-file-cut-outer-hover, .single-file-cut-selected, .single-file-cut-outer-selected { transition: outline-width 125ms !important; outline-offset: -4px !important; outline-width: 4px !important; } .single-file-cut-hover, .single-file-cut-outer-hover { outline-style: dotted !important; } .single-file-cut-selected, .single-file-cut-outer-selected { outline-style: dashed !important; } .single-file-cut-hover, .single-file-cut-selected { outline-color: red !important; } .single-file-cut-outer-hover, .single-file-cut-outer-selected { outline-color: green !important; } .single-file-cut-mode, .single-file-cut-mode * { pointer-events: auto !important; touch-action: none !important; } .single-file-cut-hover, .single-file-cut-outer-hover, .single-file-remove-highlights-mode .single-file-highlight:hover { cursor: crosshair !important; } .single-file-removed { display: none !important; float: none !important; position: static !important; visibility: collapse !important; } a[href], img { -webkit-touch-callout: none; }</style><script data-template-shadow-root>(() => { document.currentScript.remove(); const processNode = node => { node.querySelectorAll("template[shadowroot]").forEach(element=>{ let shadowRoot = getShadowRoot(element.parentElement); if (!shadowRoot) { try { shadowRoot = element.parentElement.attachShadow({mode:element.getAttribute("shadowroot")}); shadowRoot.innerHTML = element.innerHTML; element.remove(); } catch (error) {} if (shadowRoot) { processNode(shadowRoot); } } }) }; const FORBIDDEN_TAG_NAMES = ["a","area","audio","base","br","col","command","embed","hr","img","iframe","input","keygen","link","meta","param","source","track","video","wbr"]; const NOTE_TAGNAME = "single-file-note"; const NOTE_CLASS = "note"; const NOTE_ANCHORED_CLASS = "note-anchored"; const NOTE_SELECTED_CLASS = "note-selected"; const NOTE_MOVING_CLASS = "note-moving"; const NOTE_MASK_MOVING_CLASS = "note-mask-moving"; const MASK_CLASS = "single-file-mask"; const HIGHLIGHT_CLASS = "single-file-highlight"; const NOTES_WEB_STYLESHEET = ".note { all: initial; display: flex; flex-direction: column; height: 150px; width: 150px; position: absolute; top: 10px; left: 10px; border: 1px solid rgb(191, 191, 191); z-index: 2147483646; box-shadow: 3px 3px 3px rgba(33, 33, 33, .7); min-height: 100px; min-width: 100px; } .note-selected { z-index: 2147483647; } .note-hidden { display: none; } .note-collapsed { min-height: 30px; max-height: 30px; overflow: hidden; } .note blockquote { all: initial; padding: 1px; height: 100%; } .note textarea { all: initial; white-space: break-spaces; font-family: Arial, Helvetica, sans-serif; font-size: 14px; height: 100%; width: 100%; padding: 2px; border: 1px solid transparent; resize: none; color: black; } .note textarea:focus { border: 1px dotted rgb(160, 160, 160); } .note header { all: initial; min-height: 30px; cursor: grab; user-select: none; } .note .note-remove { all: initial; position: absolute; right: 0px; top: 2px; padding: 5px; opacity: .5; cursor: pointer; user-select: none; width: 16px; height: 16px; } .note .note-anchor { all: initial; position: absolute; left: 0px; top: 2px; padding: 5px; opacity: .25; cursor: pointer; width: 16px; height: 16px; } .note .note-resize { all: initial; position: absolute; bottom: -5px; right: -5px; height: 15px; width: 15px; cursor: nwse-resize; user-select: none; } .note .note-remove:hover { opacity: 1; } .note .note-anchor:hover { opacity: .5; } .note-anchored .note-anchor { opacity: .5; } .note-anchored .note-anchor:hover { opacity: 1; } .note-moving { opacity: .75; box-shadow: 6px 6px 3px rgba(33, 33, 33, .7); } .note-moving * { cursor: grabbing; } .note-yellow header { background-color: #f5f545; } .note-yellow blockquote { background-color: #ffff7c; } .note-pink header { background-color: #ffa59f; } .note-pink blockquote { background-color: #ffbbb6; } .note-blue header { background-color: #84c8ff; } .note-blue blockquote { background-color: #95d0ff; } .note-green header { background-color: #93ef8d; } .note-green blockquote { background-color: #9cff95; }"; const MASK_WEB_STYLESHEET = ".note-mask { all: initial; position: fixed; z-index: 2147483645; pointer-events: none; background-color: transparent; transition: background-color 125ms; } .note-mask-moving.note-yellow { background-color: rgba(255, 255, 124, .3); } .note-mask-moving.note-pink { background-color: rgba(255, 187, 182, .3); } .note-mask-moving.note-blue { background-color: rgba(149, 208, 255, .3); } .note-mask-moving.note-green { background-color: rgba(156, 255, 149, .3); } .page-mask { all: initial; position: fixed; top: 0; left: 0; width: 0; height: 0; z-index: 2147483646; } .page-mask-active { width: 100vw; height: 100vh; }"; const NOTE_HEADER_HEIGHT = 25; const PAGE_MASK_ACTIVE_CLASS = "page-mask-active"; const REMOVED_CONTENT_CLASS = "single-file-removed"; const reflowNotes = function reflowNotes() { document.querySelectorAll(NOTE_TAGNAME).forEach(containerElement => { const noteElement = containerElement.shadowRoot.querySelector("." + NOTE_CLASS); const noteBoundingRect = noteElement.getBoundingClientRect(); const anchorElement = getAnchorElement(containerElement); const anchorBoundingRect = anchorElement.getBoundingClientRect(); const maxX = anchorBoundingRect.x + Math.max(0, anchorBoundingRect.width - noteBoundingRect.width); const minX = anchorBoundingRect.x; const maxY = anchorBoundingRect.y + Math.max(0, anchorBoundingRect.height - NOTE_HEADER_HEIGHT); const minY = anchorBoundingRect.y; let left = parseInt(noteElement.style.getPropertyValue("left")); let top = parseInt(noteElement.style.getPropertyValue("top")); if (noteBoundingRect.x > maxX) { left -= noteBoundingRect.x - maxX; } if (noteBoundingRect.x < minX) { left += minX - noteBoundingRect.x; } if (noteBoundingRect.y > maxY) { top -= noteBoundingRect.y - maxY; } if (noteBoundingRect.y < minY) { top += minY - noteBoundingRect.y; } noteElement.style.setProperty("position", "absolute"); noteElement.style.setProperty("left", left + "px"); noteElement.style.setProperty("top", top + "px"); }); }; const addNoteRef = function addNoteRef(anchorElement, noteId) { const noteRefs = getNoteRefs(anchorElement); noteRefs.push(noteId); setNoteRefs(anchorElement, noteRefs); }; const deleteNoteRef = function deleteNoteRef(containerElement, noteId) { const anchorElement = getAnchorElement(containerElement); const noteRefs = getNoteRefs(anchorElement).filter(noteRefs => noteRefs != noteId); if (noteRefs.length) { setNoteRefs(anchorElement, noteRefs); } else { delete anchorElement.dataset.singleFileNoteRefs; } }; const getNoteRefs = function getNoteRefs(anchorElement) { return anchorElement.dataset.singleFileNoteRefs ? anchorElement.dataset.singleFileNoteRefs.split(" ") : []; }; const setNoteRefs = function setNoteRefs(anchorElement, noteRefs) { anchorElement.dataset.singleFileNoteRefs = noteRefs.join(" "); }; const getAnchorElement = function getAnchorElement(containerElement) { return document.querySelector("[data-single-file-note-refs~=\"" + containerElement.dataset.noteId + "\"]") || document.documentElement; }; const getMaskElement = function getMaskElement(className, containerClassName) { let maskElement = document.documentElement.querySelector("." + className); if (!maskElement) { maskElement = document.createElement("div"); const maskContainerElement = document.createElement("div"); if (containerClassName) { maskContainerElement.classList.add(containerClassName); } maskContainerElement.classList.add(MASK_CLASS); const firstNote = document.querySelector(NOTE_TAGNAME); if (firstNote && firstNote.parentElement == document.documentElement) { document.documentElement.insertBefore(maskContainerElement, firstNote); } else { document.documentElement.appendChild(maskContainerElement); } maskElement.classList.add(className); const maskShadow = maskContainerElement.attachShadow({ mode: "open" }); maskShadow.appendChild(getStyleElement(MASK_WEB_STYLESHEET)); maskShadow.appendChild(maskElement); return maskElement; } }; const getStyleElement = function getStyleElement(stylesheet) { const linkElement = document.createElement("style"); linkElement.textContent = stylesheet; return linkElement; }; const attachNoteListeners = function attachNoteListeners(containerElement, editable = false) { const SELECT_PX_THRESHOLD = 4; const COLLAPSING_NOTE_DELAY = 750; const noteShadow = containerElement.shadowRoot; const noteElement = noteShadow.childNodes[1]; const headerElement = noteShadow.querySelector("header"); const mainElement = noteShadow.querySelector("textarea"); const noteId = containerElement.dataset.noteId; const resizeElement = noteShadow.querySelector(".note-resize"); const anchorIconElement = noteShadow.querySelector(".note-anchor"); const removeNoteElement = noteShadow.querySelector(".note-remove"); mainElement.readOnly = !editable; if (!editable) { anchorIconElement.style.setProperty("display", "none", "important"); } else { anchorIconElement.style.removeProperty("display"); } headerElement.ontouchstart = headerElement.onmousedown = event => { if (event.target == headerElement) { collapseNoteTimeout = setTimeout(() => { noteElement.classList.toggle("note-collapsed"); hideMaskNote(); }, COLLAPSING_NOTE_DELAY); event.preventDefault(); const position = getPosition(event); const clientX = position.clientX; const clientY = position.clientY; const boundingRect = noteElement.getBoundingClientRect(); const deltaX = clientX - boundingRect.left; const deltaY = clientY - boundingRect.top; maskPageElement.classList.add(PAGE_MASK_ACTIVE_CLASS); document.documentElement.style.setProperty("user-select", "none", "important"); anchorElement = getAnchorElement(containerElement); displayMaskNote(); selectNote(noteElement); moveNote(event, deltaX, deltaY); movingNoteMode = { event, deltaX, deltaY }; document.documentElement.ontouchmove = document.documentElement.onmousemove = event => { clearTimeout(collapseNoteTimeout); if (!movingNoteMode) { movingNoteMode = { deltaX, deltaY }; } movingNoteMode.event = event; moveNote(event, deltaX, deltaY); }; } }; resizeElement.ontouchstart = resizeElement.onmousedown = event => { event.preventDefault(); resizingNoteMode = true; selectNote(noteElement); maskPageElement.classList.add(PAGE_MASK_ACTIVE_CLASS); document.documentElement.style.setProperty("user-select", "none", "important"); document.documentElement.ontouchmove = document.documentElement.onmousemove = event => { event.preventDefault(); const { clientX, clientY } = getPosition(event); const boundingRectNote = noteElement.getBoundingClientRect(); noteElement.style.width = clientX - boundingRectNote.left + "px"; noteElement.style.height = clientY - boundingRectNote.top + "px"; }; }; anchorIconElement.ontouchend = anchorIconElement.onclick = event => { event.preventDefault(); noteElement.classList.toggle(NOTE_ANCHORED_CLASS); if (!noteElement.classList.contains(NOTE_ANCHORED_CLASS)) { deleteNoteRef(containerElement, noteId); addNoteRef(document.documentElement, noteId); } onUpdate(false); }; removeNoteElement.ontouchend = removeNoteElement.onclick = event => { event.preventDefault(); deleteNoteRef(containerElement, noteId); containerElement.remove(); }; noteElement.onmousedown = () => { selectNote(noteElement); }; function moveNote(event, deltaX, deltaY) { event.preventDefault(); const { clientX, clientY } = getPosition(event); noteElement.classList.add(NOTE_MOVING_CLASS); if (editable) { if (noteElement.classList.contains(NOTE_ANCHORED_CLASS)) { deleteNoteRef(containerElement, noteId); anchorElement = getTarget(clientX, clientY) || document.documentElement; addNoteRef(anchorElement, noteId); } else { anchorElement = document.documentElement; } } document.documentElement.insertBefore(containerElement, maskPageElement.getRootNode().host); noteElement.style.setProperty("left", (clientX - deltaX) + "px"); noteElement.style.setProperty("top", (clientY - deltaY) + "px"); noteElement.style.setProperty("position", "fixed"); displayMaskNote(); } function displayMaskNote() { if (anchorElement == document.documentElement || anchorElement == document.documentElement) { hideMaskNote(); } else { const boundingRectAnchor = anchorElement.getBoundingClientRect(); maskNoteElement.classList.add(NOTE_MASK_MOVING_CLASS); if (selectedNote) { maskNoteElement.classList.add(selectedNote.dataset.color); } maskNoteElement.style.setProperty("top", (boundingRectAnchor.y - 3) + "px"); maskNoteElement.style.setProperty("left", (boundingRectAnchor.x - 3) + "px"); maskNoteElement.style.setProperty("width", (boundingRectAnchor.width + 3) + "px"); maskNoteElement.style.setProperty("height", (boundingRectAnchor.height + 3) + "px"); } } function hideMaskNote() { maskNoteElement.classList.remove(NOTE_MASK_MOVING_CLASS); if (selectedNote) { maskNoteElement.classList.remove(selectedNote.dataset.color); } } function selectNote(noteElement) { if (selectedNote) { selectedNote.classList.remove(NOTE_SELECTED_CLASS); maskNoteElement.classList.remove(selectedNote.dataset.color); } noteElement.classList.add(NOTE_SELECTED_CLASS); noteElement.classList.add(noteElement.dataset.color); selectedNote = noteElement; } function getTarget(clientX, clientY) { const targets = Array.from(document.elementsFromPoint(clientX, clientY)).filter(element => element.matches("html *:not(" + NOTE_TAGNAME + "):not(." + MASK_CLASS + ")")); if (!targets.includes(document.documentElement)) { targets.push(document.documentElement); } let newTarget, target = targets[0], boundingRect = target.getBoundingClientRect(); newTarget = determineTargetElement("floor", target, clientX - boundingRect.left, getMatchedParents(target, "left")); if (newTarget == target) { newTarget = determineTargetElement("ceil", target, boundingRect.left + boundingRect.width - clientX, getMatchedParents(target, "right")); } if (newTarget == target) { newTarget = determineTargetElement("floor", target, clientY - boundingRect.top, getMatchedParents(target, "top")); } if (newTarget == target) { newTarget = determineTargetElement("ceil", target, boundingRect.top + boundingRect.height - clientY, getMatchedParents(target, "bottom")); } target = newTarget; while (boundingRect = target && target.getBoundingClientRect(), boundingRect && boundingRect.width <= SELECT_PX_THRESHOLD && boundingRect.height <= SELECT_PX_THRESHOLD) { target = target.parentElement; } return target; } function getMatchedParents(target, property) { let element = target, matchedParent, parents = []; do { const boundingRect = element.getBoundingClientRect(); if (element.parentElement && !element.parentElement.tagName.toLowerCase() != NOTE_TAGNAME && !element.classList.contains(MASK_CLASS)) { const parentBoundingRect = element.parentElement.getBoundingClientRect(); matchedParent = Math.abs(parentBoundingRect[property] - boundingRect[property]) <= SELECT_PX_THRESHOLD; if (matchedParent) { if (element.parentElement.clientWidth > SELECT_PX_THRESHOLD && element.parentElement.clientHeight > SELECT_PX_THRESHOLD && ((element.parentElement.clientWidth - element.clientWidth > SELECT_PX_THRESHOLD) || (element.parentElement.clientHeight - element.clientHeight > SELECT_PX_THRESHOLD))) { parents.push(element.parentElement); } element = element.parentElement; } } else { matchedParent = false; } } while (matchedParent && element); return parents; } function determineTargetElement(roundingMethod, target, widthDistance, parents) { if (Math[roundingMethod](widthDistance / SELECT_PX_THRESHOLD) <= parents.length) { target = parents[parents.length - Math[roundingMethod](widthDistance / SELECT_PX_THRESHOLD) - 1]; } return target; } }; const anchorNote = function anchorNote(event, noteElement, deltaX, deltaY) { event.preventDefault(); const { clientX, clientY } = getPosition(event); document.documentElement.style.removeProperty("user-select"); noteElement.classList.remove(NOTE_MOVING_CLASS); maskNoteElement.classList.remove(NOTE_MASK_MOVING_CLASS); maskPageElement.classList.remove(PAGE_MASK_ACTIVE_CLASS); maskNoteElement.classList.remove(noteElement.dataset.color); const headerElement = noteElement.querySelector("header"); headerElement.ontouchmove = document.documentElement.onmousemove = null; let currentElement = anchorElement; let positionedElement; while (currentElement.parentElement && !positionedElement) { if (!FORBIDDEN_TAG_NAMES.includes(currentElement.tagName.toLowerCase())) { const currentElementStyle = getComputedStyle(currentElement); if (currentElementStyle.position != "static") { positionedElement = currentElement; } } currentElement = currentElement.parentElement; } if (!positionedElement) { positionedElement = document.documentElement; } const containerElement = noteElement.getRootNode().host; if (positionedElement == document.documentElement) { const firstMaskElement = document.querySelector("." + MASK_CLASS); firstMaskElement.parentElement.insertBefore(containerElement, firstMaskElement); } else { positionedElement.appendChild(containerElement); } const boundingRectPositionedElement = positionedElement.getBoundingClientRect(); const stylePositionedElement = window.getComputedStyle(positionedElement); const borderX = parseInt(stylePositionedElement.getPropertyValue("border-left-width")); const borderY = parseInt(stylePositionedElement.getPropertyValue("border-top-width")); noteElement.style.setProperty("position", "absolute"); noteElement.style.setProperty("left", (clientX - boundingRectPositionedElement.x - deltaX - borderX) + "px"); noteElement.style.setProperty("top", (clientY - boundingRectPositionedElement.y - deltaY - borderY) + "px"); }; const getPosition = function getPosition(event) { if (event.touches && event.touches.length) { const touch = event.touches[0]; return touch; } else { return event; } }; const onMouseUp = function onMouseUp(event) { if (highlightSelectionMode) { event.preventDefault(); highlightSelection(); onUpdate(false); } if (removeHighlightMode) { event.preventDefault(); let element = event.target, done; while (element && !done) { if (element.classList.contains(HIGHLIGHT_CLASS)) { document.querySelectorAll("." + HIGHLIGHT_CLASS + "[data-singlefile-highlight-id=" + JSON.stringify(element.dataset.singlefileHighlightId) + "]").forEach(highlightedElement => { resetHighlightedElement(highlightedElement); onUpdate(false); }); done = true; } element = element.parentElement; } } if (resizingNoteMode) { event.preventDefault(); resizingNoteMode = false; document.documentElement.style.removeProperty("user-select"); maskPageElement.classList.remove(PAGE_MASK_ACTIVE_CLASS); document.documentElement.ontouchmove = onTouchMove; document.documentElement.onmousemove = null; onUpdate(false); } if (movingNoteMode) { event.preventDefault(); anchorNote(movingNoteMode.event || event, selectedNote, movingNoteMode.deltaX, movingNoteMode.deltaY); movingNoteMode = null; document.documentElement.ontouchmove = onTouchMove; document.documentElement.onmousemove = null; onUpdate(false); } if ((cuttingMode || cuttingOuterMode) && cuttingPath) { event.preventDefault(); if (event.ctrlKey) { const element = cuttingPath[cuttingPathIndex]; element.classList.toggle(cuttingMode ? CUT_SELECTED_CLASS : CUT_OUTER_SELECTED_CLASS); } else { validateCutElement(event.shiftKey); } } if (collapseNoteTimeout) { clearTimeout(collapseNoteTimeout); collapseNoteTimeout = null; } }; const getShadowRoot = function getShadowRoot(element) { const chrome = window.chrome; if (element.openOrClosedShadowRoot) { return element.openOrClosedShadowRoot; } else if (chrome && chrome.dom && chrome.dom.openOrClosedShadowRoot) { try { return chrome.dom.openOrClosedShadowRoot(element); } catch (error) { return element.shadowRoot; } } else { return element.shadowRoot; } }; const maskNoteElement = getMaskElement("note-mask"); const maskPageElement = getMaskElement("page-mask", "single-file-page-mask"); let selectedNote, highlightSelectionMode, removeHighlightMode, resizingNoteMode, movingNoteMode, collapseNoteTimeout, cuttingMode, cuttingOuterMode; window.onresize = reflowNotes; window.onUpdate = () => {}; document.documentElement.onmouseup = document.documentElement.ontouchend = onMouseUp; processNode(document); reflowNotes(); document.querySelectorAll("single-file-note").forEach(noteElement => attachNoteListeners(noteElement)); })()</script>
<script type="text/javascript" src="/1.js"></script></body>
</html>