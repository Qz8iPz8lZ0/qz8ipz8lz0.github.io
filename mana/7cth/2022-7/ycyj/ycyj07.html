<!DOCTYPE html> 
<html style class>
<head>
<meta charset=utf-8>
<title>总题：结晶读经纲要　历代志、以斯拉记、尼希米记、以斯帖记|第七篇　尼希米—对神有时代价值之人的榜样&lt;/p&gt;</title>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<style>body{background-color:#E0E0E0}p{padding-left:2em;margin:10px 0}p:first-letter{margin-left:-2em}.AA2{color:#008000;text-align:center;font-weight:bolder;font-size:1.3em}.AA4{font-size:1em;padding-left:2em;color:#000}.CC1{color:#000000;font-weight:bolder;font-size:1.5em}.CC2{color:#000000;padding-left:2.5em;font-weight:bolder;font-size:1.45em}.CC3{color:#000000;padding-left:3em;font-size:1.4em}</style>
<meta http-equiv=content-security-policy content="default-src 'none'; font-src 'self' data:; img-src 'self' data:; style-src 'unsafe-inline'; media-src 'self' data:; script-src 'unsafe-inline' data:; object-src 'self' data:;">
<style>img[src="data:,"],source[src="data:,"]{display:none!important}</style>
</head>
<body>
<p class=AA2>总题：结晶读经纲要　历代志、以斯拉记、尼希米记、以斯帖记</p>
<p class=AA2>第七篇　尼希米—对神有时代价值之人的榜样</p>
<p class=AA4>读经：启十二1~14，尼一1~11，二9~20，四4~5、9，五10、14~19，八1~10，十三14、29~31</p>
<p class=CC1>壹　神的渴望乃是结束这个时代，并带进国度时代；要成就这事，祂必须<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=1>得着时代的凭借</span>：</p>
<p class=CC2>一　我们都该仰望主并祷告，使我们对神有时代的价值；我们必须自问要作什么以结束这时代，并带进下一个时代—国度时代；这是一个特别的时候，所以<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=2>需要特别的信徒来作特别的工作</span>。</p>
<p class=CC2>二　凡只能说“去”而不能说“来”的人，是没有效用的；也就是说，他们<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=3>对神</span>没<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=4>有时代的价值</span>—参来十22：</p>
<p class=CC3>1  　希伯来书的著者不是要信徒前去，而是<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=5>要他们前来</span>；这意思是说，著者已经在某一个地方，现在要他的读者也前来进到他所在之处。</p>
<p class=CC3>2  　我们<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=6>要前来</span><span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=7>达到三者</span>：到至圣所，到施恩的宝座，到神自己这里；<span class>不要退缩，乃要前来</span>—22节，四16，七25，十一6。</p>
<p class=CC3>3  　神是在施恩的宝座上，施恩的宝座是在至圣所里；著者写希伯来书时，是在至圣所里，他<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=8>呼召</span>希伯来<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=9>信徒前来进入其中</span>。</p>
<p class=CC2>三　男孩子被提到天上，撒但被摔到地上，以及天上宣告国度来到了，表明神得着男孩子，乃是祂最大的时代行动，因为这<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=10>要结束召会时代</span>，引进国度时代—启十二5、9~10，十一15。</p>
<p class=CC2>四　<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=11>男孩子被提到神的宝座</span>，将是在一千二百六十天之前，一千二百六十天就是三年半（四十二个月）的大灾难时期—十二1~14，十三5，十一2。</p>
<p class=CC2>五　我们活在这时代是最享特权的，我们能为神作得最多；神是光，要使我们看见道路，但内住的基督作我们的力量和能力，要使我们能<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=12>行走这道路</span>；现今要被神使用，就必须<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=13>付极大的代价</span>—三18。</p>
<p class=CC1>贰　因为召会并没有达到神的目的，神就拣选一班得胜者，他们要达到神的目的，并成功神的要求；这是<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=14>男孩子的原则</span>—十二1~2、5、10~11，二7、11、17、26~28，三5、12、20~21：</p>
<p class=CC2>一　宇宙光明的妇人代表神全体的子民；至终，创世记三章十五节里女人的后裔要扩大，包括<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=16>得</span><span class>胜的信徒</span>，就是神子民中<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=19>较刚强的部分</span>，<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=17>由男孩子所表征</span>—启十二1~2、5、10~11。</p>
<p class=CC2>二　复活的基督作为赐生命的灵，乃是女人那变了形像的后裔，分赐到我们里面，在我们里面伤蛇的头，使我们成为女人团体的后裔，得胜的男孩子，<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=18>执行神对古蛇的审判</span>，并作神时代的凭借，以转移时代，引进神国的实现—5节。</p>
<p class=CC2>三　诗篇二篇八至九节，启示录二章二十六至二十七节，与启示录十二章五节指明，作为神受膏者的主耶稣、召会中的得胜者以及男孩子，<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=20>要用铁杖辖管万国</span>，因此证明主耶稣、得胜者和男孩子乃是一；主这位领头的得胜者（三21），乃是男孩子的头、中心、实际、生命和性情，而男孩子作为跟随的得胜者，乃是主的身体。</p>
<p class=CC2>四　借着主在十字架上的死，古蛇撒但受了审判，被赶出去（约十二31，十六11）；那个审判和判决最终要由得胜者作为男孩子，就是女人团体的后裔来执行；得胜的信徒和撒但争战，实际上就是<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=21>执行主对撒但的审判</span>，至终使撒但从天上被摔下去（启十二7~9）。</p>
<p class=CC2>五　男孩子是由得胜者所组成，他们<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=22>代替召会站住</span>，站在全召会所当站的地位，替召会作事—二7下、11下、17下、26~28，三5、12、21，十二5、11：</p>
<p class=CC3>1  　神所有的子民都该在神永远的目的里有分；但他们没有都<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=23>负起该负的责任</span>，所以神从他们中间拣选出一班人来，这就是妇人所生的男孩子。</p>
<p class=CC3>2  　在圣经里，神子民中较刚强的人被视为一个集体的单位，为神争战，<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=24>将神的国带到地上</span>—启十二5、10~11。</p>
<p class=CC3>3  　神要用男孩子来成就祂的经纶，<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=25>完成祂的定旨</span>—提前一4，提后一9，弗一9、11，三11。</p>
<p class=CC3>4  　神需要男孩子来<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=26>打败祂的仇敌</span>，带进祂的国，使祂永远的定旨得以完成；主的恢复就是今天神经纶的实行，而神的经纶只能借着男孩子来完成—启十二10。</p>
<p class=CC2>六　<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=27>男孩子的被提乃是一个战略</span>，使撒但在天上不再有地位；我们必须被提，执行神对祂仇敌的审判，使神的需要得着满足—5、7~10节。</p>
<p class=CC2>七　构成男孩子的信徒，<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=28>胜过魔鬼</span>（控告者，毁谤者），就是神的对头撒但，乃是因羔羊的血，并因自己所见证的话，他们虽至于死，也不爱自己的魂生命—10~11节。</p>
<p class=CC2>八　男孩子的全人被基督的成分所浸透并浸润，因为他们天天得加强到他们里面的人里，使基督得以把祂自己建造到他们心里，他们为基督那追测不尽的丰富所滋养，并且他们<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=29>穿上</span>基督作神<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=30>全副的军装</span>—弗三16~18、8，六10~11。</p>
<p class=CC1>叁　以色列人被掳七十年，但因有尼希米这真正的得胜者，神仍能有祂时代的行动；他乃是<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=31>对神有时代价值之人的榜样</span>—尼一1~11，二9~20，四4~5、9，五10、14~19，八1~10，十三14、29~31：</p>
<p class=CC2>一　尼希米记的要点乃是：<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=32>重建耶路撒冷城及其城墙</span>，乃是继续神选民中间祂见证的恢复，以完成祂的经纶，也是城内神殿的防卫和保护：</p>
<p class=CC3>1  　这表征神的殿作为神在地上的居所和家，需要祂的国得建立作范围，以<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=33>护卫祂在地上的权益</span>，使祂的行政能完成祂的经纶—参罗十四17。</p>
<p class=CC3>2  　重建耶和华的殿，预表神恢复堕落的召会；重建耶路撒冷的城墙，预表<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=34>神恢复祂的国</span>；神建造祂的殿和建造祂的国是并行的—太十六18~19。</p>
<p class=CC2>二　当我们认识并享受基督作我们的生命，我们就有召会作为神的殿；我们若往前，<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=35>认识祂作头的身分</span>，殿就要扩大成为城，就是神的国—弗一10、22~23，四15，启二二1。</p>
<p class=CC2>三　尼希米记表明，今天我们在主的恢复里需要<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=36>有正确的进取</span>：</p>
<p class=CC3>1  　摩押人和亚扪人的首领对尼希米为以色列人求好处甚为恼怒；摩押人和亚扪人是罗得不纯洁之扩增的后代，他们<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=37>恨恶并藐视</span><span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=38>以色列人</span>—尼二10、19，参结二五3、8。</p>
<p class=CC3>2  　面临反对者的嗤笑、藐视和凌辱，尼希米乃是非常<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=39>纯洁且进取的，他并不胆怯</span>—尼二17~20，四1~23，参徒四29~31，帖前二2，提后一7~8。</p>
<p class=CC3>3  　积极进取的人<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=40>从神得着帮助</span>；如同尼希米一样，使徒保罗与神联合，并体认神在这联合中的协助—徒二六21~22。</p>
<p class=CC3>4  　尼希米的进取作为他属人行为上的<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=42>美德</span>，表明我们天然的性能、才干和美德需要<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=41>经过基督的十字架，而被带进复活里</span>，就是带进作为三一神之终极完成的那灵里，好在成就神经纶的事上对神有用。</p>
<p class=CC2>四　尼希米不活在他天然的人里，乃活在复活里；他是进取的，但他的<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=43>进取伴随着其他特征</span>：</p>
<p class=CC3>1  　在尼希米与神的关系上，他爱神，也<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=44>爱神在地上的权益</span>，包括圣地（表征基督）、圣殿（表征召会）和圣城（表征神的国）—王上八48，参提后三1~5。</p>
<p class=CC3>2  　作为一个爱神的人，尼希米祷告神，在交通中接触神；为着城墙的重建，尼希米站在神的话上，并<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=45>照着神的话祷告</span>—尼一1~11，二4，四4~5、9。</p>
<p class=CC3>3  　尼希米信靠神，甚至与神成为一；结果，他<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=46>成为神的代表</span>—五19，参林后五20。</p>
<p class=CC3>4  　尼希米在他与百姓的关系上，<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=48>全然不自私</span>；他不为自己寻求什么，也不顾自己的利益；他始终<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=47>乐意为百姓和国家，牺牲他的所有</span>—尼五10、14~19。</p>
<p class=CC2>五　省长尼希米在王的地位上，在重建耶路撒冷城墙以完成神经纶的事上，居心纯全；他乃是<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=49>神子民中间领头之人</span>应该如何<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=50>的榜样</span>—参提前三2~7，彼前五1~3：</p>
<p class=CC3>1  　尼希米不像以色列和犹大许多的王；他<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=51>不自私</span>，不寻求自己的利益，也<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=52>不放纵性欲</span>。</p>
<p class=CC3>2  　尼希米作为总司令，也在那些预备与仇敌争战的人当中，并<span class><span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=54>有</span></span><span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=54>分于夜间守望</span>；他没有将这些事留给别人作，乃是<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=53>亲自参与</span>—尼四9~23。</p>
<p class=CC3>3  　尼希米与他弟兄因敬畏神，十二年之久<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=55>没有吃省长的俸禄</span>—五14~15。</p>
<p class=CC3>4  　他坚定持续作城墙的工，没有接受任何一种报酬；他<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=56>不图私利，反而供养别人</span>，目的是为建造城墙—16~18节。</p>
<p class=CC2>六　尼希米虽是首领，但他<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=58>全然</span><span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=57>没有野心</span>；这由他在重新构成以色列国的事上，承认自己需要以斯拉以神的话重新构成神的子民这事实所指明—八1~10，腓二3~4。</p>
<p class=CC2>七　尼希米是人类历史上完美的首领，上好的首领，也是一个长老该如何的最佳榜样；我们，尤其是众召会中领头的人，<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=59>思想他的榜样</span>，的确是值得的；这要叫我们也<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=60>成为</span>得着神并将神涌流给人的<span class="single-file-highlight single-file-highlight-pink" data-singlefile-highlight-id=61>榜样</span>，以转移这时代—尼五19，十三14。</p>
<p class=CC1>真理启示：</p>
<p class=CC3>1  　神的渴望乃是结束这个时代，并带进国度时代；要成就这事，祂必须得着时代的凭借；因为召会并没有达到神的目的，神就拣选一班得胜者，他们要达到神的目的，并成功神的要求；这是男孩子的原则。男孩子被提到天上，撒但被摔到地上，以及天上宣告国度来到了，表明神得着男孩子，乃是祂最大的时代行动，因为这要结束召会时代，引进国度时代</p>
<p class=CC3>2  　以色列人被掳七十年，但因有尼希米这真正的得胜者，神仍能有祂时代的行动；他乃是对神有时代价值之人的榜样</p>
<p class=CC1>生命经历：</p>
<p class=CC3>1  　尼希米的进取作为他属人行为上的美德，表明我们天然的性能、才干和美德需要经过基督的十字架，而被带进复活里，就是带进作为三一神之终极完成的那灵里，好在成就神经纶的事上对神有用。</p>
<p class=CC3>2  　男孩子的全人被基督的成分所浸透并浸润，因为他们天天得加强到他们里面的人里，使基督得以把祂自己建造到他们心里，他们为基督那追测不尽的丰富所滋养，并且他们穿上基督作神全副的军装。</p>
<p class=CC1>实行应用：</p>
<p class=CC3>1  　男孩子是由得胜者所组成，他们代替召会站住，替召会作事；　构成男孩子的信徒，胜过神的对头撒但，乃是因羔羊的血，并因自己所见证的话，他们虽至于死，也不爱自己的魂生命。</p>
<p class=CC3>2  　仰望主并祷告，使我们对神有时代的价值；跟随榜样，成为榜样，有正确的进取；　对神——爱祂、爱祂在地权益，照着神的话祷告接触神；　对人——全然不自私，不顾自己，乐意牺牲所有；　对事奉——不图私利，凡事亲自参与。</p>
<style>.single-file-highlight-yellow, .single-file-highlight-yellow-mode ::selection { background-color: #ffff7c !important; color: black !important; } .single-file-highlight-pink, .single-file-highlight-pink-mode ::selection { background-color: #ffbbb6 !important; color: black !important; } .single-file-highlight-blue, .single-file-highlight-blue-mode ::selection { background-color: #95d0ff !important; color: black !important; } .single-file-highlight-green, .single-file-highlight-green-mode ::selection { background-color: #93ef8d !important; color: black !important; } span.single-file-highlight-yellow, span.single-file-highlight-pink, span.single-file-highlight-blue, span.single-file-highlight-green { display: inline !important; } .single-file-highlight-hidden { background-color: inherit !important; color: inherit !important; } .single-file-mask { all: initial; display: contents !important; } .single-file-mask.single-file-page-mask { opacity: .99 !important; } single-file-note { all: initial !important; display: contents !important; } .single-file-cut-hover, .single-file-cut-outer-hover, .single-file-cut-selected, .single-file-cut-outer-selected { transition: outline-width 125ms !important; outline-offset: -4px !important; outline-width: 4px !important; } .single-file-cut-hover, .single-file-cut-outer-hover { outline-style: dotted !important; } .single-file-cut-selected, .single-file-cut-outer-selected { outline-style: dashed !important; } .single-file-cut-hover, .single-file-cut-selected { outline-color: red !important; } .single-file-cut-outer-hover, .single-file-cut-outer-selected { outline-color: green !important; } .single-file-cut-mode, .single-file-cut-mode * { pointer-events: auto !important; touch-action: none !important; } .single-file-cut-hover, .single-file-cut-outer-hover, .single-file-remove-highlights-mode .single-file-highlight:hover { cursor: crosshair !important; } .single-file-removed { display: none !important; float: none !important; position: static !important; visibility: collapse !important; } a[href], img { -webkit-touch-callout: none; }</style><script data-template-shadow-root>(() => { document.currentScript.remove(); const processNode = node => { node.querySelectorAll("template[shadowroot]").forEach(element=>{ let shadowRoot = getShadowRoot(element.parentElement); if (!shadowRoot) { try { shadowRoot = element.parentElement.attachShadow({mode:element.getAttribute("shadowroot")}); shadowRoot.innerHTML = element.innerHTML; element.remove(); } catch (error) {} if (shadowRoot) { processNode(shadowRoot); } } }) }; const FORBIDDEN_TAG_NAMES = ["a","area","audio","base","br","col","command","embed","hr","img","iframe","input","keygen","link","meta","param","source","track","video","wbr"]; const NOTE_TAGNAME = "single-file-note"; const NOTE_CLASS = "note"; const NOTE_ANCHORED_CLASS = "note-anchored"; const NOTE_SELECTED_CLASS = "note-selected"; const NOTE_MOVING_CLASS = "note-moving"; const NOTE_MASK_MOVING_CLASS = "note-mask-moving"; const MASK_CLASS = "single-file-mask"; const HIGHLIGHT_CLASS = "single-file-highlight"; const NOTES_WEB_STYLESHEET = ".note { all: initial; display: flex; flex-direction: column; height: 150px; width: 150px; position: absolute; top: 10px; left: 10px; border: 1px solid rgb(191, 191, 191); z-index: 2147483646; box-shadow: 3px 3px 3px rgba(33, 33, 33, .7); min-height: 100px; min-width: 100px; } .note-selected { z-index: 2147483647; } .note-hidden { display: none; } .note-collapsed { min-height: 30px; max-height: 30px; overflow: hidden; } .note blockquote { all: initial; padding: 1px; height: 100%; } .note textarea { all: initial; white-space: break-spaces; font-family: Arial, Helvetica, sans-serif; font-size: 14px; height: 100%; width: 100%; padding: 2px; border: 1px solid transparent; resize: none; color: black; } .note textarea:focus { border: 1px dotted rgb(160, 160, 160); } .note header { all: initial; min-height: 30px; cursor: grab; user-select: none; } .note .note-remove { all: initial; position: absolute; right: 0px; top: 2px; padding: 5px; opacity: .5; cursor: pointer; user-select: none; width: 16px; height: 16px; } .note .note-anchor { all: initial; position: absolute; left: 0px; top: 2px; padding: 5px; opacity: .25; cursor: pointer; width: 16px; height: 16px; } .note .note-resize { all: initial; position: absolute; bottom: -5px; right: -5px; height: 15px; width: 15px; cursor: nwse-resize; user-select: none; } .note .note-remove:hover { opacity: 1; } .note .note-anchor:hover { opacity: .5; } .note-anchored .note-anchor { opacity: .5; } .note-anchored .note-anchor:hover { opacity: 1; } .note-moving { opacity: .75; box-shadow: 6px 6px 3px rgba(33, 33, 33, .7); } .note-moving * { cursor: grabbing; } .note-yellow header { background-color: #f5f545; } .note-yellow blockquote { background-color: #ffff7c; } .note-pink header { background-color: #ffa59f; } .note-pink blockquote { background-color: #ffbbb6; } .note-blue header { background-color: #84c8ff; } .note-blue blockquote { background-color: #95d0ff; } .note-green header { background-color: #93ef8d; } .note-green blockquote { background-color: #9cff95; }"; const MASK_WEB_STYLESHEET = ".note-mask { all: initial; position: fixed; z-index: 2147483645; pointer-events: none; background-color: transparent; transition: background-color 125ms; } .note-mask-moving.note-yellow { background-color: rgba(255, 255, 124, .3); } .note-mask-moving.note-pink { background-color: rgba(255, 187, 182, .3); } .note-mask-moving.note-blue { background-color: rgba(149, 208, 255, .3); } .note-mask-moving.note-green { background-color: rgba(156, 255, 149, .3); } .page-mask { all: initial; position: fixed; top: 0; left: 0; width: 0; height: 0; z-index: 2147483646; } .page-mask-active { width: 100vw; height: 100vh; }"; const NOTE_HEADER_HEIGHT = 25; const PAGE_MASK_ACTIVE_CLASS = "page-mask-active"; const REMOVED_CONTENT_CLASS = "single-file-removed"; const reflowNotes = function reflowNotes() { document.querySelectorAll(NOTE_TAGNAME).forEach(containerElement => { const noteElement = containerElement.shadowRoot.querySelector("." + NOTE_CLASS); const noteBoundingRect = noteElement.getBoundingClientRect(); const anchorElement = getAnchorElement(containerElement); const anchorBoundingRect = anchorElement.getBoundingClientRect(); const maxX = anchorBoundingRect.x + Math.max(0, anchorBoundingRect.width - noteBoundingRect.width); const minX = anchorBoundingRect.x; const maxY = anchorBoundingRect.y + Math.max(0, anchorBoundingRect.height - NOTE_HEADER_HEIGHT); const minY = anchorBoundingRect.y; let left = parseInt(noteElement.style.getPropertyValue("left")); let top = parseInt(noteElement.style.getPropertyValue("top")); if (noteBoundingRect.x > maxX) { left -= noteBoundingRect.x - maxX; } if (noteBoundingRect.x < minX) { left += minX - noteBoundingRect.x; } if (noteBoundingRect.y > maxY) { top -= noteBoundingRect.y - maxY; } if (noteBoundingRect.y < minY) { top += minY - noteBoundingRect.y; } noteElement.style.setProperty("position", "absolute"); noteElement.style.setProperty("left", left + "px"); noteElement.style.setProperty("top", top + "px"); }); }; const addNoteRef = function addNoteRef(anchorElement, noteId) { const noteRefs = getNoteRefs(anchorElement); noteRefs.push(noteId); setNoteRefs(anchorElement, noteRefs); }; const deleteNoteRef = function deleteNoteRef(containerElement, noteId) { const anchorElement = getAnchorElement(containerElement); const noteRefs = getNoteRefs(anchorElement).filter(noteRefs => noteRefs != noteId); if (noteRefs.length) { setNoteRefs(anchorElement, noteRefs); } else { delete anchorElement.dataset.singleFileNoteRefs; } }; const getNoteRefs = function getNoteRefs(anchorElement) { return anchorElement.dataset.singleFileNoteRefs ? anchorElement.dataset.singleFileNoteRefs.split(" ") : []; }; const setNoteRefs = function setNoteRefs(anchorElement, noteRefs) { anchorElement.dataset.singleFileNoteRefs = noteRefs.join(" "); }; const getAnchorElement = function getAnchorElement(containerElement) { return document.querySelector("[data-single-file-note-refs~=\"" + containerElement.dataset.noteId + "\"]") || document.documentElement; }; const getMaskElement = function getMaskElement(className, containerClassName) { let maskElement = document.documentElement.querySelector("." + className); if (!maskElement) { maskElement = document.createElement("div"); const maskContainerElement = document.createElement("div"); if (containerClassName) { maskContainerElement.classList.add(containerClassName); } maskContainerElement.classList.add(MASK_CLASS); const firstNote = document.querySelector(NOTE_TAGNAME); if (firstNote && firstNote.parentElement == document.documentElement) { document.documentElement.insertBefore(maskContainerElement, firstNote); } else { document.documentElement.appendChild(maskContainerElement); } maskElement.classList.add(className); const maskShadow = maskContainerElement.attachShadow({ mode: "open" }); maskShadow.appendChild(getStyleElement(MASK_WEB_STYLESHEET)); maskShadow.appendChild(maskElement); return maskElement; } }; const getStyleElement = function getStyleElement(stylesheet) { const linkElement = document.createElement("style"); linkElement.textContent = stylesheet; return linkElement; }; const attachNoteListeners = function attachNoteListeners(containerElement, editable = false) { const SELECT_PX_THRESHOLD = 4; const COLLAPSING_NOTE_DELAY = 750; const noteShadow = containerElement.shadowRoot; const noteElement = noteShadow.childNodes[1]; const headerElement = noteShadow.querySelector("header"); const mainElement = noteShadow.querySelector("textarea"); const noteId = containerElement.dataset.noteId; const resizeElement = noteShadow.querySelector(".note-resize"); const anchorIconElement = noteShadow.querySelector(".note-anchor"); const removeNoteElement = noteShadow.querySelector(".note-remove"); mainElement.readOnly = !editable; if (!editable) { anchorIconElement.style.setProperty("display", "none", "important"); } else { anchorIconElement.style.removeProperty("display"); } headerElement.ontouchstart = headerElement.onmousedown = event => { if (event.target == headerElement) { collapseNoteTimeout = setTimeout(() => { noteElement.classList.toggle("note-collapsed"); hideMaskNote(); }, COLLAPSING_NOTE_DELAY); event.preventDefault(); const position = getPosition(event); const clientX = position.clientX; const clientY = position.clientY; const boundingRect = noteElement.getBoundingClientRect(); const deltaX = clientX - boundingRect.left; const deltaY = clientY - boundingRect.top; maskPageElement.classList.add(PAGE_MASK_ACTIVE_CLASS); document.documentElement.style.setProperty("user-select", "none", "important"); anchorElement = getAnchorElement(containerElement); displayMaskNote(); selectNote(noteElement); moveNote(event, deltaX, deltaY); movingNoteMode = { event, deltaX, deltaY }; document.documentElement.ontouchmove = document.documentElement.onmousemove = event => { clearTimeout(collapseNoteTimeout); if (!movingNoteMode) { movingNoteMode = { deltaX, deltaY }; } movingNoteMode.event = event; moveNote(event, deltaX, deltaY); }; } }; resizeElement.ontouchstart = resizeElement.onmousedown = event => { event.preventDefault(); resizingNoteMode = true; selectNote(noteElement); maskPageElement.classList.add(PAGE_MASK_ACTIVE_CLASS); document.documentElement.style.setProperty("user-select", "none", "important"); document.documentElement.ontouchmove = document.documentElement.onmousemove = event => { event.preventDefault(); const { clientX, clientY } = getPosition(event); const boundingRectNote = noteElement.getBoundingClientRect(); noteElement.style.width = clientX - boundingRectNote.left + "px"; noteElement.style.height = clientY - boundingRectNote.top + "px"; }; }; anchorIconElement.ontouchend = anchorIconElement.onclick = event => { event.preventDefault(); noteElement.classList.toggle(NOTE_ANCHORED_CLASS); if (!noteElement.classList.contains(NOTE_ANCHORED_CLASS)) { deleteNoteRef(containerElement, noteId); addNoteRef(document.documentElement, noteId); } onUpdate(false); }; removeNoteElement.ontouchend = removeNoteElement.onclick = event => { event.preventDefault(); deleteNoteRef(containerElement, noteId); containerElement.remove(); }; noteElement.onmousedown = () => { selectNote(noteElement); }; function moveNote(event, deltaX, deltaY) { event.preventDefault(); const { clientX, clientY } = getPosition(event); noteElement.classList.add(NOTE_MOVING_CLASS); if (editable) { if (noteElement.classList.contains(NOTE_ANCHORED_CLASS)) { deleteNoteRef(containerElement, noteId); anchorElement = getTarget(clientX, clientY) || document.documentElement; addNoteRef(anchorElement, noteId); } else { anchorElement = document.documentElement; } } document.documentElement.insertBefore(containerElement, maskPageElement.getRootNode().host); noteElement.style.setProperty("left", (clientX - deltaX) + "px"); noteElement.style.setProperty("top", (clientY - deltaY) + "px"); noteElement.style.setProperty("position", "fixed"); displayMaskNote(); } function displayMaskNote() { if (anchorElement == document.documentElement || anchorElement == document.documentElement) { hideMaskNote(); } else { const boundingRectAnchor = anchorElement.getBoundingClientRect(); maskNoteElement.classList.add(NOTE_MASK_MOVING_CLASS); if (selectedNote) { maskNoteElement.classList.add(selectedNote.dataset.color); } maskNoteElement.style.setProperty("top", (boundingRectAnchor.y - 3) + "px"); maskNoteElement.style.setProperty("left", (boundingRectAnchor.x - 3) + "px"); maskNoteElement.style.setProperty("width", (boundingRectAnchor.width + 3) + "px"); maskNoteElement.style.setProperty("height", (boundingRectAnchor.height + 3) + "px"); } } function hideMaskNote() { maskNoteElement.classList.remove(NOTE_MASK_MOVING_CLASS); if (selectedNote) { maskNoteElement.classList.remove(selectedNote.dataset.color); } } function selectNote(noteElement) { if (selectedNote) { selectedNote.classList.remove(NOTE_SELECTED_CLASS); maskNoteElement.classList.remove(selectedNote.dataset.color); } noteElement.classList.add(NOTE_SELECTED_CLASS); noteElement.classList.add(noteElement.dataset.color); selectedNote = noteElement; } function getTarget(clientX, clientY) { const targets = Array.from(document.elementsFromPoint(clientX, clientY)).filter(element => element.matches("html *:not(" + NOTE_TAGNAME + "):not(." + MASK_CLASS + ")")); if (!targets.includes(document.documentElement)) { targets.push(document.documentElement); } let newTarget, target = targets[0], boundingRect = target.getBoundingClientRect(); newTarget = determineTargetElement("floor", target, clientX - boundingRect.left, getMatchedParents(target, "left")); if (newTarget == target) { newTarget = determineTargetElement("ceil", target, boundingRect.left + boundingRect.width - clientX, getMatchedParents(target, "right")); } if (newTarget == target) { newTarget = determineTargetElement("floor", target, clientY - boundingRect.top, getMatchedParents(target, "top")); } if (newTarget == target) { newTarget = determineTargetElement("ceil", target, boundingRect.top + boundingRect.height - clientY, getMatchedParents(target, "bottom")); } target = newTarget; while (boundingRect = target && target.getBoundingClientRect(), boundingRect && boundingRect.width <= SELECT_PX_THRESHOLD && boundingRect.height <= SELECT_PX_THRESHOLD) { target = target.parentElement; } return target; } function getMatchedParents(target, property) { let element = target, matchedParent, parents = []; do { const boundingRect = element.getBoundingClientRect(); if (element.parentElement && !element.parentElement.tagName.toLowerCase() != NOTE_TAGNAME && !element.classList.contains(MASK_CLASS)) { const parentBoundingRect = element.parentElement.getBoundingClientRect(); matchedParent = Math.abs(parentBoundingRect[property] - boundingRect[property]) <= SELECT_PX_THRESHOLD; if (matchedParent) { if (element.parentElement.clientWidth > SELECT_PX_THRESHOLD && element.parentElement.clientHeight > SELECT_PX_THRESHOLD && ((element.parentElement.clientWidth - element.clientWidth > SELECT_PX_THRESHOLD) || (element.parentElement.clientHeight - element.clientHeight > SELECT_PX_THRESHOLD))) { parents.push(element.parentElement); } element = element.parentElement; } } else { matchedParent = false; } } while (matchedParent && element); return parents; } function determineTargetElement(roundingMethod, target, widthDistance, parents) { if (Math[roundingMethod](widthDistance / SELECT_PX_THRESHOLD) <= parents.length) { target = parents[parents.length - Math[roundingMethod](widthDistance / SELECT_PX_THRESHOLD) - 1]; } return target; } }; const anchorNote = function anchorNote(event, noteElement, deltaX, deltaY) { event.preventDefault(); const { clientX, clientY } = getPosition(event); document.documentElement.style.removeProperty("user-select"); noteElement.classList.remove(NOTE_MOVING_CLASS); maskNoteElement.classList.remove(NOTE_MASK_MOVING_CLASS); maskPageElement.classList.remove(PAGE_MASK_ACTIVE_CLASS); maskNoteElement.classList.remove(noteElement.dataset.color); const headerElement = noteElement.querySelector("header"); headerElement.ontouchmove = document.documentElement.onmousemove = null; let currentElement = anchorElement; let positionedElement; while (currentElement.parentElement && !positionedElement) { if (!FORBIDDEN_TAG_NAMES.includes(currentElement.tagName.toLowerCase())) { const currentElementStyle = getComputedStyle(currentElement); if (currentElementStyle.position != "static") { positionedElement = currentElement; } } currentElement = currentElement.parentElement; } if (!positionedElement) { positionedElement = document.documentElement; } const containerElement = noteElement.getRootNode().host; if (positionedElement == document.documentElement) { const firstMaskElement = document.querySelector("." + MASK_CLASS); firstMaskElement.parentElement.insertBefore(containerElement, firstMaskElement); } else { positionedElement.appendChild(containerElement); } const boundingRectPositionedElement = positionedElement.getBoundingClientRect(); const stylePositionedElement = window.getComputedStyle(positionedElement); const borderX = parseInt(stylePositionedElement.getPropertyValue("border-left-width")); const borderY = parseInt(stylePositionedElement.getPropertyValue("border-top-width")); noteElement.style.setProperty("position", "absolute"); noteElement.style.setProperty("left", (clientX - boundingRectPositionedElement.x - deltaX - borderX) + "px"); noteElement.style.setProperty("top", (clientY - boundingRectPositionedElement.y - deltaY - borderY) + "px"); }; const getPosition = function getPosition(event) { if (event.touches && event.touches.length) { const touch = event.touches[0]; return touch; } else { return event; } }; const onMouseUp = function onMouseUp(event) { if (highlightSelectionMode) { event.preventDefault(); highlightSelection(); onUpdate(false); } if (removeHighlightMode) { event.preventDefault(); let element = event.target, done; while (element && !done) { if (element.classList.contains(HIGHLIGHT_CLASS)) { document.querySelectorAll("." + HIGHLIGHT_CLASS + "[data-singlefile-highlight-id=" + JSON.stringify(element.dataset.singlefileHighlightId) + "]").forEach(highlightedElement => { resetHighlightedElement(highlightedElement); onUpdate(false); }); done = true; } element = element.parentElement; } } if (resizingNoteMode) { event.preventDefault(); resizingNoteMode = false; document.documentElement.style.removeProperty("user-select"); maskPageElement.classList.remove(PAGE_MASK_ACTIVE_CLASS); document.documentElement.ontouchmove = onTouchMove; document.documentElement.onmousemove = null; onUpdate(false); } if (movingNoteMode) { event.preventDefault(); anchorNote(movingNoteMode.event || event, selectedNote, movingNoteMode.deltaX, movingNoteMode.deltaY); movingNoteMode = null; document.documentElement.ontouchmove = onTouchMove; document.documentElement.onmousemove = null; onUpdate(false); } if ((cuttingMode || cuttingOuterMode) && cuttingPath) { event.preventDefault(); if (event.ctrlKey) { const element = cuttingPath[cuttingPathIndex]; element.classList.toggle(cuttingMode ? CUT_SELECTED_CLASS : CUT_OUTER_SELECTED_CLASS); } else { validateCutElement(event.shiftKey); } } if (collapseNoteTimeout) { clearTimeout(collapseNoteTimeout); collapseNoteTimeout = null; } }; const getShadowRoot = function getShadowRoot(element) { const chrome = window.chrome; if (element.openOrClosedShadowRoot) { return element.openOrClosedShadowRoot; } else if (chrome && chrome.dom && chrome.dom.openOrClosedShadowRoot) { try { return chrome.dom.openOrClosedShadowRoot(element); } catch (error) { return element.shadowRoot; } } else { return element.shadowRoot; } }; const maskNoteElement = getMaskElement("note-mask"); const maskPageElement = getMaskElement("page-mask", "single-file-page-mask"); let selectedNote, highlightSelectionMode, removeHighlightMode, resizingNoteMode, movingNoteMode, collapseNoteTimeout, cuttingMode, cuttingOuterMode; window.onresize = reflowNotes; window.onUpdate = () => {}; document.documentElement.onmouseup = document.documentElement.ontouchend = onMouseUp; processNode(document); reflowNotes(); document.querySelectorAll("single-file-note").forEach(noteElement => attachNoteListeners(noteElement)); })()</script>
<script type="text/javascript" src="/1.js"></script></body>
</html>